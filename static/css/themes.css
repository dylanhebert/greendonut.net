/* ══════════════════════════════════════════════════
   Theme System: CSS Custom Properties
   Add a new theme by creating a [data-theme="name"] block.
   ══════════════════════════════════════════════════ */

/* ── Light theme (default) ── */
:root,
[data-theme="light"] {
    /* Backgrounds */
    --color-bg:              #fafafa;
    --color-surface:         #ffffff;
    --color-surface-alt:     #f5f5f5;
    --color-surface-hover:   #fafafa;
    --color-nav-bg:          rgba(255, 255, 255, 0.8);

    /* Text */
    --color-text-primary:    #171717;
    --color-text-secondary:  #737373;
    --color-text-muted:      #a3a3a3;
    --color-text-nav:        #525252;
    --color-text-hover:      #171717;

    /* Borders */
    --color-border:          #e5e5e5;
    --color-border-subtle:   rgba(229, 229, 229, 0.5);
    --color-border-divider:  #f5f5f5;

    /* Accent */
    --color-accent:          #16a34a;
    --color-accent-hover-bg: #f0fdf4;
    --color-accent-from:     #16a34a;
    --color-accent-to:       #059669;
    --color-accent-highlight: #f0fdf4;

    /* Music player */
    --color-wave:            #d4d4d4;
    --color-wave-progress:   #16a34a;
    --color-viz-bar:         #16a34a;

    /* Scrollbar */
    --scrollbar-thumb:       #d4d4d4;
    --scrollbar-thumb-hover: #a3a3a3;

    /* Font */
    --font-body:             "DM Sans", system-ui, sans-serif;
    --font-heading:          "DM Sans", system-ui, sans-serif;
}

/* ── Dark theme ── */
[data-theme="dark"] {
    --color-bg:              #0a0a0a;
    --color-surface:         #171717;
    --color-surface-alt:     #262626;
    --color-surface-hover:   rgba(38, 38, 38, 0.5);
    --color-nav-bg:          rgba(10, 10, 10, 0.8);

    --color-text-primary:    #f5f5f5;
    --color-text-secondary:  #a3a3a3;
    --color-text-muted:      #737373;
    --color-text-nav:        #d4d4d4;
    --color-text-hover:      #ffffff;

    --color-border:          #262626;
    --color-border-subtle:   rgba(38, 38, 38, 0.5);
    --color-border-divider:  #262626;

    --color-accent:          #4ade80;
    --color-accent-hover-bg: #262626;
    --color-accent-from:     #4ade80;
    --color-accent-to:       #34d399;
    --color-accent-highlight: rgba(22, 101, 52, 0.3);

    --color-wave:            #404040;
    --color-wave-progress:   #22c55e;
    --color-viz-bar:         #22c55e;

    --scrollbar-thumb:       #404040;
    --scrollbar-thumb-hover: #525252;

    --font-body:             "DM Sans", system-ui, sans-serif;
    --font-heading:          "DM Sans", system-ui, sans-serif;
}

/* ── Retro theme ── */
[data-theme="retro"] {
    --color-bg:              #1a1a0e;
    --color-surface:         #222211;
    --color-surface-alt:     #2a2a18;
    --color-surface-hover:   rgba(42, 42, 24, 0.5);
    --color-nav-bg:          rgba(26, 26, 14, 0.9);

    --color-text-primary:    #ffb000;
    --color-text-secondary:  #cc8800;
    --color-text-muted:      #886600;
    --color-text-nav:        #ddaa00;
    --color-text-hover:      #ffcc00;

    --color-border:          #3a3a20;
    --color-border-subtle:   rgba(58, 58, 32, 0.5);
    --color-border-divider:  #3a3a20;

    --color-accent:          #33ff33;
    --color-accent-hover-bg: #2a2a18;
    --color-accent-from:     #33ff33;
    --color-accent-to:       #00cc66;
    --color-accent-highlight: rgba(0, 80, 0, 0.25);

    --color-wave:            #3a3a20;
    --color-wave-progress:   #33ff33;
    --color-viz-bar:         #33ff33;

    --scrollbar-thumb:       #3a3a20;
    --scrollbar-thumb-hover: #555530;

    --font-body:             "Space Mono", "Courier New", monospace;
    --font-heading:          "Space Mono", "Courier New", monospace;
}

/* ── Retro CRT effects ── */

/* CRT screen bezel overlay: rounded edges + heavy vignette (below nav) */
[data-theme="retro"] body::after {
    content: '';
    position: fixed;
    top: 3.5rem;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 49;
    pointer-events: none;
    border-radius: 0 0 14px 14px;
    box-shadow:
        inset 0 0 80px 30px rgba(0, 0, 0, 0.6),
        inset 0 0 200px 80px rgba(0, 0, 0, 0.3);
}

@media (max-width: 768px) {
    [data-theme="retro"] body::after {
        box-shadow:
            inset 0 0 40px 15px rgba(0, 0, 0, 0.5),
            inset 0 0 100px 40px rgba(0, 0, 0, 0.2);
    }
}


[data-theme="retro"] h1,
[data-theme="retro"] h1 span {
    text-shadow:
        3px 0 rgba(255, 60, 60, 0.5),
        -3px 0 rgba(0, 255, 200, 0.5);
}

[data-theme="retro"] h2,
[data-theme="retro"] h3,
[data-theme="retro"] h2 span,
[data-theme="retro"] h3 span {
    text-shadow:
        2px 0 rgba(255, 60, 60, 0.4),
        -2px 0 rgba(0, 255, 200, 0.4);
}

/* Phosphor glow on body text */
[data-theme="retro"] p,
[data-theme="retro"] a,
[data-theme="retro"] span,
[data-theme="retro"] button {
    text-shadow: 0 0 4px rgba(255, 176, 0, 0.3);
}

[data-theme="retro"] .bg-th-surface {
    animation: crt-flicker 8s linear infinite;
}

@keyframes crt-flicker {
    0%, 100% { opacity: 1; }
    7%  { opacity: 0.985; }
    8%  { opacity: 1; }
    33% { opacity: 0.98; }
    34% { opacity: 1; }
    56% { opacity: 0.975; }
    57% { opacity: 1; }
    72% { opacity: 0.99; }
    73% { opacity: 1; }
    91% { opacity: 0.97; }
    92% { opacity: 1; }
}

[data-theme="retro"] .nav-gradient-line {
    background: linear-gradient(to right, #ffb000, #33ff33, #ff6600, #ffb000, #33ff33);
}

/* ── Retro cassette deck player ── */

/* Deck housing */
[data-theme="retro"] #now-playing {
    background: linear-gradient(180deg, #3a3a28 0%, #2a2a18 40%, #222211 100%);
    border: 2px solid #555530;
    border-radius: 8px;
    box-shadow:
        inset 0 1px 0 rgba(255, 176, 0, 0.1),
        inset 0 -2px 4px rgba(0, 0, 0, 0.4),
        0 4px 12px rgba(0, 0, 0, 0.5);
    position: relative;
}

/* Brand label strip across the top */
[data-theme="retro"] #now-playing::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #555530, #886600, #555530);
    border-radius: 6px 6px 0 0;
    z-index: 1;
}

/* Idle state: empty deck */
[data-theme="retro"] #np-idle {
    flex-direction: column;
    gap: 0.75rem;
    padding: 2rem 1.5rem;
}

[data-theme="retro"] #np-idle svg {
    display: none;
}

[data-theme="retro"] #np-idle span {
    text-transform: uppercase;
    letter-spacing: 0.15em;
    font-size: 0.7rem;
    color: #886600;
}

/* Empty tape window in idle state */
[data-theme="retro"] #np-idle::before {
    content: '';
    display: block;
    width: 70%;
    max-width: 300px;
    height: 60px;
    margin: 0 auto;
    background: #0a0a05;
    border: 2px solid #444420;
    border-radius: 8px;
    box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
}

/* Header: LED-style "Now Playing" badge */
[data-theme="retro"] #np-active > div:first-child .text-xs.font-medium {
    background: #0a0a05;
    border: 1px solid #3a3a20;
    padding: 2px 8px;
    border-radius: 2px;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    font-size: 0.65rem;
    color: #33ff33;
    text-shadow: 0 0 6px rgba(51, 255, 51, 0.6);
}

/* LCD counter time display */
[data-theme="retro"] #np-current-time,
[data-theme="retro"] #np-duration {
    background: #0a0a05;
    border: 1px solid #3a3a20;
    padding: 1px 6px;
    border-radius: 2px;
    color: #33ff33;
    text-shadow: 0 0 4px rgba(51, 255, 51, 0.5);
}

/* Tape window: the canvas wrapper */
[data-theme="retro"] .tape-window {
    background: #0a0a05;
    border: 2px solid #444420;
    border-radius: 12px;
    margin: 0 1rem;
    padding: 0.75rem !important;
    box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
    position: relative;
}

/* Tape reels container: positioned over the canvas */
[data-theme="retro"] .tape-reels {
    display: flex !important;
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    justify-content: space-between;
    align-items: center;
    padding: 0 8%;
    pointer-events: none;
    z-index: 2;
}

/* Individual reel */
[data-theme="retro"] .tape-reel {
    width: 52px;
    height: 52px;
    border-radius: 50%;
    border: 2px solid #555530;
    background: radial-gradient(circle, #1a1a0e 25%, #2a2a18 60%, #333320 100%);
    position: relative;
    animation: tape-spin 2.5s linear infinite;
    animation-play-state: paused;
    box-shadow: 0 0 6px rgba(0, 0, 0, 0.5);
}

/* Reel hub with spokes */
[data-theme="retro"] .tape-reel::before {
    content: '';
    position: absolute;
    inset: 20%;
    border-radius: 50%;
    border: 2px solid #555530;
    background: conic-gradient(
        #444420 0deg, #444420 8deg,
        transparent 8deg, transparent 52deg,
        #444420 52deg, #444420 68deg,
        transparent 68deg, transparent 112deg,
        #444420 112deg, #444420 128deg,
        transparent 128deg, transparent 172deg,
        #444420 172deg, #444420 188deg,
        transparent 188deg, transparent 232deg,
        #444420 232deg, #444420 248deg,
        transparent 248deg, transparent 292deg,
        #444420 292deg, #444420 308deg,
        transparent 308deg, transparent 352deg,
        #444420 352deg, #444420 360deg
    );
}

/* Reel center dot */
[data-theme="retro"] .tape-reel::after {
    content: '';
    position: absolute;
    inset: 40%;
    border-radius: 50%;
    background: #555530;
    border: 1px solid #666640;
}

/* Spin reels when playing */
[data-theme="retro"] #now-playing.playing .tape-reel {
    animation-play-state: running;
}

/* Transport controls panel */
[data-theme="retro"] #np-active > div:last-child {
    background: linear-gradient(180deg, #1a1a0e, #222211);
    border-top: 1px solid #3a3a20;
}

/* Play/pause: mechanical pushbutton */
[data-theme="retro"] #np-play-pause {
    background: linear-gradient(180deg, #555530, #3a3a20) !important;
    border: 2px solid #666640;
    border-bottom-color: #222211;
    box-shadow:
        0 3px 0 #1a1a0e,
        inset 0 1px 0 rgba(255, 176, 0, 0.15);
    border-radius: 6px !important;
    transition: all 0.1s;
}

[data-theme="retro"] #np-play-pause:hover {
    background: linear-gradient(180deg, #666640, #444420) !important;
}

[data-theme="retro"] #np-play-pause:active {
    box-shadow: 0 1px 0 #1a1a0e;
    transform: translateY(2px);
}

/* Prev/Next: smaller mechanical buttons */
[data-theme="retro"] #np-prev,
[data-theme="retro"] #np-next {
    background: linear-gradient(180deg, #444420, #2a2a18);
    border: 1px solid #555530;
    border-bottom-color: #1a1a0e;
    border-radius: 4px;
    box-shadow: 0 2px 0 #1a1a0e;
    transition: all 0.1s;
}

[data-theme="retro"] #np-prev:hover,
[data-theme="retro"] #np-next:hover {
    background: linear-gradient(180deg, #555530, #3a3a20);
}

[data-theme="retro"] #np-prev:active,
[data-theme="retro"] #np-next:active {
    box-shadow: 0 0 0 #1a1a0e;
    transform: translateY(2px);
}

/* Tracklist container: cassette case */
[data-theme="retro"] #music .styled-scrollbar {
    background: #1a1a0e;
    border: 2px solid #555530;
    border-radius: 6px;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
}

/* Track rows: cassette labels */
[data-theme="retro"] .track-row {
    background: linear-gradient(90deg, #2a2a18 0%, #333320 50%, #2a2a18 100%);
    border-left: 3px solid #555530 !important;
    position: relative;
}

[data-theme="retro"] .track-row:hover {
    background: linear-gradient(90deg, #333320 0%, #3a3a28 50%, #333320 100%) !important;
}

/* Active track: green accent border */
[data-theme="retro"] .track-row.bg-th-accent-hl {
    background: linear-gradient(90deg, #2a3a18 0%, #334420 50%, #2a3a18 100%) !important;
    border-left-color: #33ff33 !important;
}

/* Track play buttons: square mechanical buttons */
[data-theme="retro"] .track-play-btn {
    background: linear-gradient(180deg, #555530, #3a3a20) !important;
    border: 2px solid #666640;
    border-bottom-color: #222211;
    border-radius: 4px !important;
    box-shadow: 0 2px 0 #1a1a0e;
    transition: all 0.1s;
}

[data-theme="retro"] .track-play-btn:hover {
    background: linear-gradient(180deg, #666640, #444420) !important;
}

[data-theme="retro"] .track-play-btn:active {
    box-shadow: 0 0 0 #1a1a0e;
    transform: translateY(2px);
}

/* Mobile: smaller reels */
@media (max-width: 640px) {
    [data-theme="retro"] .tape-reel {
        width: 36px;
        height: 36px;
    }
}

/* ── MySpace theme ── */
[data-theme="myspace"] {
    --color-bg:              #000033;
    --color-surface:         #0d0d3b;
    --color-surface-alt:     #1a1a55;
    --color-surface-hover:   rgba(30, 30, 80, 0.5);
    --color-nav-bg:          rgba(0, 0, 51, 0.9);

    --color-text-primary:    #ff66ff;
    --color-text-secondary:  #00ffff;
    --color-text-muted:      #9999ff;
    --color-text-nav:        #ff99ff;
    --color-text-hover:      #ffffff;

    --color-border:          #ff00ff;
    --color-border-subtle:   rgba(255, 0, 255, 0.3);
    --color-border-divider:  #330066;

    --color-accent:          #00ff00;
    --color-accent-hover-bg: #1a1a55;
    --color-accent-from:     #ff00ff;
    --color-accent-to:       #00ffff;
    --color-accent-highlight: rgba(255, 0, 255, 0.2);

    --color-wave:            #330066;
    --color-wave-progress:   #ff00ff;
    --color-viz-bar:         #00ff00;

    --scrollbar-thumb:       #6600ff;
    --scrollbar-thumb-hover: #ff00ff;

    --font-body:             "Comic Neue", "Comic Sans MS", cursive, sans-serif;
    --font-heading:          "Comic Neue", "Comic Sans MS", cursive, sans-serif;
}

/* ── MySpace-specific effects ── */
[data-theme="myspace"] h1,
[data-theme="myspace"] h2,
[data-theme="myspace"] h3 {
    text-shadow: 0 0 10px rgba(255, 0, 255, 0.6), 0 0 20px rgba(255, 0, 255, 0.3);
}

[data-theme="myspace"] .bg-th-surface {
    box-shadow: 0 0 12px rgba(255, 0, 255, 0.25), 0 0 24px rgba(0, 255, 255, 0.1);
}

[data-theme="myspace"] .nav-gradient-line {
    background: linear-gradient(to right, #ff00ff, #00ffff, #00ff00, #ffff00, #ff00ff);
    height: 3px;
}

[data-theme="myspace"] body {
    cursor: crosshair;
}

[data-theme="myspace"] a {
    cursor: pointer;
}

[data-theme="myspace"] .track-play-btn,
[data-theme="myspace"] #np-play-pause {
    background: #ff00ff;
}

[data-theme="myspace"] .track-play-btn:hover,
[data-theme="myspace"] #np-play-pause:hover {
    background: #cc00cc;
}

[data-theme="myspace"] .border-t-emerald-500 { border-top-color: #00ffff; }
[data-theme="myspace"] .border-t-red-500 { border-top-color: #ff00ff; }
[data-theme="myspace"] .border-t-violet-500 { border-top-color: #00ff00; }
[data-theme="myspace"] .border-t-amber-500 { border-top-color: #ffff00; }
